<% content_for :title, "EmailBolt" %>
<% if @lookup != nil %>
<% temparray = JSON.parse(get_data(@lookup.to_s)) %>
<% temparray = temparray.keys %>
<% threats = temparray.length %>
<% total = 12 - threats %>
<% end %>
<br />
<div class="row">
    <% if total == nil %>
    <div class="row">
    <div class="large-12 columns">
    <h3>See what your email is saying about you!</h3>
    <%= render ('shared/emailcheck') %>
    </div>
    </div>
    <% end %>
    <% if total != nil %>
    <div class="row">
    <h3>Results</h3>
    <br />
    
        <div class="row">

            <div class="large-12 columns">

                <div class="large-4 medium-5 small-12 columns left">
                    <canvas id="results" width="500px" height="400px"></canvas>
                </div>

                <div class="large-8 medium-7 small-12 columns left">
                    
                    <div class="panel large-12 medium-12 small-12 columns">
                    
                    <h4>Your security status.</h4>
                        <div class="large-6 small-12 columns">
                            <div class="large-4 medium-2 small-12 columns" style="height:40px;width:40px;background-color:#FF8153;"></div>
                            <div class="large-8 medium-10 small-12 columns right"><h6>There were <%= threats %> data point matches.</h6></div>
                        </div>
                        <div class="large-6 columns">
                            <div class="large-4 medium-2 small-12 columns" style="height:40px;width:40px;background-color:#FFEA88;"></div>
                            <div class="large-8 medium-10 small-12 columns right"><h6>There were <%= total %> data points missing.</h6></div>
                        </div>
                            
                    </div>


                </div>

            </div>
        </div>


    <br />


        <!-- Thumbnails -->
        <div class="row">
        <% if temparray.length != 0 %>
            <h4>What's publicly available for your email adam@mit.edu</h4>
        <% end %>
            <div class="large-12 columns">

                <% temparray.each do |b| %>

                <div class="large-3 medium-4 small-6 columns left">
                    <%= image_tag ('data/' + b + '256.png'), :style => "width:100%;height:auto;" %>
                    <div class="panel">
                        <h5><%= b.humanize %></h5>
                    </div>
                </div>

                <% end %>    

            </div>

        </div>
        <!-- End Thumbnails -->

        
    </div> 
    <% end %>
</div>

<style>
    canvas
        {
        width: 100% !important;
        max-width: 800px;
        height: auto !important;
        }
</style>

<script>
var buyerData = [
    {
        label : 'Sleep',
        labelColor : 'white',
        labelFontSize : '16',
        value : <%= threats %>,
        color : "#FF8153"
    },
    {
        label : 'Sleep',
        labelColor : 'white',
        labelFontSize : '16',
        value : <%= total %>,
        color : "#FFEA88"
    }
];

var pieOptions = {
    segmentShowStroke : true,
    segmentStrokeColor : "#fff",
    segmentStrokeWidth : 2,
    percentageInnerCutout : 50,
    animation : true,
    animationSteps : 100,
    animationEasing : "easeOutBounce",
    animateRotate : true,
    animateScale : false,
    onAnimationComplete : "revealInfo()",
    labelFontFamily : "Arial",
    labelFontStyle : "normal",
    labelFontSize : 24,
    labelFontColor : "#666"
}

function revealInfo()
{
    alert("Hello World!");
}

var results = document.getElementById('results').getContext('2d');
new Chart(results).Pie(buyerData,pieOptions);
</script>
<%= render ('shared/footer') %>